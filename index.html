<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>生成excel</title>
</head>
<body>
<input type="button" value="生成表" />

<script type="text/javascript" src="./utils/shim.min.js"></script>
<script type="text/javascript" src="./utils/xlsx.full.min.js"></script>

<script type="text/javascript">
  window.onload = (event) => {
    main()
  }
  function main() {
    const button = document.querySelector("input[type=button]")

    button.onclick = (event) => {
      const data = [{"id":1,"tagName":"BFA_L1R_HS_TE14513_AI_10s_cur","descr":"1号助燃风机前轴承温度1","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":2,"tagName":"BFA_L1R_HS_TE14514_AI_10s_cur","descr":"1号助燃风机后轴承温度2","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":3,"tagName":"BFA_L1R_HS_ZT14512_AI_10s_cur","descr":"1号助燃风机固定端径向振动","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":4,"tagName":"BFA_L1R_HS_ZT14511_AI_10s_cur","descr":"1号助燃风机固定端轴向振动","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":5,"tagName":"BFA_L1R_HS_TE14531_AI_10s_cur","descr":"1号助燃风机定子温度1","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":6,"tagName":"BFA_L1R_HS_TE14532_AI_10s_cur","descr":"1号助燃风机定子温度2","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":7,"tagName":"BFA_L1R_HS_TE14533_AI_10s_cur","descr":"1号助燃风机定子温度3","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":8,"tagName":"BFA_L1R_HS_TE14534_AI_10s_cur","descr":"1号助燃风机定子温度4","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":9,"tagName":"BFA_L1R_HS_TE14535_AI_10s_cur","descr":"1号助燃风机定子温度5","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":10,"tagName":"BFA_L1R_HS_TE14536_AI_10s_cur","descr":"1号助燃风机定子温度6","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":11,"tagName":"BFA_L1R_HS_TE14515_AI_10s_cur","descr":"1号助燃风机电机前轴承温度","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":12,"tagName":"BFA_L1R_HS_TE14516_AI_10s_cur","descr":"1号助燃风机电机后轴承温度","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":13,"tagName":"BFA_L1R_HS_ZT14514_AI_10s_cur","descr":"1号助燃风机自由端径向振动","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":14,"tagName":"BFA_L1R_HS_ZT14513_AI_10s_cur","descr":"1号助燃风机自由端轴向振动","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":15,"tagName":"BFA_L1R_HS_TE14511_AI_10s_cur","descr":"1号助燃风机排水温度1","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":16,"tagName":"BFA_L1R_HS_TE14512_AI_10s_cur","descr":"1号助燃风机排水温度2","type":null,"system":null,"sysType":null,"tabTitle":"1号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":17,"tagName":"BFA_L1R_HS_TE14523_AI_10s_cur","descr":"2号助燃风机前轴承温度","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":18,"tagName":"BFA_L1R_HS_TE14524_AI_10s_cur","descr":"2号助燃风机后轴承温度","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":19,"tagName":"BFA_L1R_HS_ZT14522_AI_10s_cur","descr":"2号助燃风机固定端径向振动","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":20,"tagName":"BFA_L1R_HS_ZT14521_AI_10s_cur","descr":"2号助燃风机固定端轴向振动","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":21,"tagName":"BFA_L1R_HS_TE14541_AI_10s_cur","descr":"2号助燃风机定子温度1","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":22,"tagName":"BFA_L1R_HS_TE14542_AI_10s_cur","descr":"2号助燃风机定子温度2","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":23,"tagName":"BFA_L1R_HS_TE14543_AI_10s_cur","descr":"2号助燃风机定子温度3","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":24,"tagName":"BFA_L1R_HS_TE14544_AI_10s_cur","descr":"2号助燃风机定子温度4","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":25,"tagName":"BFA_L1R_HS_TE14545_AI_10s_cur","descr":"2号助燃风机定子温度5","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":26,"tagName":"BFA_L1R_HS_TE14546_AI_10s_cur","descr":"2号助燃风机定子温度6","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":27,"tagName":"BFA_L1R_HS_TE14525_AI_10s_cur","descr":"2号助燃风机电机前轴承温度","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":28,"tagName":"BFA_L1R_HS_TE14526_AI_10s_cur","descr":"2号助燃风机电机后轴承温度","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":29,"tagName":"BFA_L1R_HS_ZT14524_AI_10s_cur","descr":"2号助燃风机自由端径向振动","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":30,"tagName":"BFA_L1R_HS_ZT14523_AI_10s_cur","descr":"2号助燃风机自由端轴向振动","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":31,"tagName":"BFA_L1R_HS_TE14521_AI_10s_cur","descr":"2号助燃风机排水温度1","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null},{"id":32,"tagName":"BFA_L1R_HS_TE14522_AI_10s_cur","descr":"2号助燃风机排水温度2","type":null,"system":null,"sysType":null,"tabTitle":"2号助燃风机","up":null,"low":null,"coorUp":null,"coorLow":null}]
      creatTable(data)
    }
  }

  function saveArrayDataToExcel(data) {
    // create a new blank workbook
    const workbook = XLSX.utils.book_new()

    const worksheetName = "SheetJS"
    const worksheetData = [
      ['title', 'name', 'tagName']
    ];
    data.forEach((item) => {
      worksheetData.push(item)
    })
    const worksheet = XLSX.utils.aoa_to_sheet(worksheetData)
    XLSX.utils.book_append_sheet(workbook, worksheet, worksheetName)
    XLSX.writeFile(workbook, `点位表${new Date().getTime()}.xlsx`)
  }
  function creatTable(data, title = 'tabTitle', name = 'descr', tagName = 'tagName') {
    const list = [];
    data.forEach((item) => {
      list.push([item[title], item[name], item[tagName]]);
    })
    saveArrayDataToExcel(list);
  }
</script>
</body>
</html>
